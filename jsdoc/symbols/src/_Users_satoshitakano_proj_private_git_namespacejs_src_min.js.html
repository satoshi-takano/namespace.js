<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='line'>  1</span> <span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">global</span><span class="PUNC">=</span><span class="NAME">window</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">namespace_lib_core</span><span class="PUNC">=</span><span class="STRN">"jp.example"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">namespace_lib_app</span><span class="PUNC">=</span><span class="NAME">namespace_lib_core</span><span class="PUNC">+</span><span class="STRN">".application"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">namespace_lib_geom</span><span class="PUNC">=</span><span class="NAME">namespace_lib_core</span><span class="PUNC">+</span><span class="STRN">".geom"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">namespace_lib_events</span><span class="PUNC">=</span><span class="NAME">namespace_lib_core</span><span class="PUNC">+</span><span class="STRN">".events"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">namespace_lib_tween</span><span class="PUNC">=</span><span class="NAME">namespace_lib_core</span><span class="PUNC">+</span><span class="STRN">".tween"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">namespace_lib_net</span><span class="PUNC">=</span><span class="NAME">namespace_lib_core</span><span class="PUNC">+</span><span class="STRN">".net"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">namespace_lib_display</span><span class="PUNC">=</span><span class="NAME">namespace_lib_core</span><span class="PUNC">+</span><span class="STRN">".display"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">namespace_lib_ui</span><span class="PUNC">=</span><span class="NAME">namespace_lib_core</span><span class="PUNC">+</span><span class="STRN">".ui"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">namespace_lib_math</span><span class="PUNC">=</span><span class="NAME">namespace_lib_core</span><span class="PUNC">+</span><span class="STRN">".math"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  2</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">namespace_lib_canvas</span><span class="PUNC">=</span><span class="NAME">namespace_lib_core</span><span class="PUNC">+</span><span class="STRN">".html5.canvas"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">namespace_lib_platform</span><span class="PUNC">=</span><span class="NAME">namespace_lib_core</span><span class="PUNC">+</span><span class="STRN">".platform"</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">global.debug</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">global.console</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">console.log</span><span class="PUNC">=</span><span class="NAME">console.error</span><span class="PUNC">=</span><span class="NAME">console.assert</span><span class="PUNC">=</span><span class="NAME">console.count</span><span class="PUNC">=</span><span class="NAME">console.debug</span><span class="PUNC">=</span><span class="NAME">console.info</span><span class="PUNC">=</span><span class="NAME">console.trace</span><span class="PUNC">=</span><span class="NAME">console.warn</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>  3</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">FunctionPrototype</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getMethodName</span><span class="PUNC">(</span><span class="NAME">method</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">=</span><span class="NAME">method.name</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">==</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">name</span><span class="PUNC">=</span><span class="REGX">/function\s*(.*)\s*\(/mgi</span><span class="PUNC">.</span><span class="NAME">exec</span><span class="PUNC">(</span><span class="NAME">method</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">}</span><span class="NAME">this.getMethodName</span><span class="PUNC">=</span><span class="NAME">getMethodName</span><span class="PUNC">;</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">wrap</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="NAME">method</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">wrapper</span><span class="PUNC">=</span><span class="NAME">method</span><span class="PUNC">;</span><span class="NAME">wrapper.superMethod</span><span class="PUNC">=</span><span class="NAME">self.substance.prototype</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">wrapper</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">$super</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">arguments.callee.caller.superMethod.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.gen</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">obj.initialize</span><span class="PUNC">!=</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">obj.initialize.apply</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>  4</span> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.getInstance</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">instance</span><span class="PUNC">=</span><span class="NAME">this.instance</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">instance</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">instance</span><span class="PUNC">=</span><span class="NAME">this.instance</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">instance.initialize</span><span class="PUNC">!=</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">instance.initialize.apply</span><span class="PUNC">(</span><span class="NAME">instance</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.instance</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.init</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">initialize</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">self.substance.prototype.initialize</span><span class="PUNC">=</span><span class="NAME">wrap</span><span class="PUNC">(</span><span class="STRN">"initialize"</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.ex</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">proto</span><span class="PUNC">=</span><span class="NAME">obj.gen</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">self.substance.superClass</span><span class="PUNC">=</span><span class="NAME">obj.prototype</span><span class="PUNC">;</span><span class="NAME">self.substance.prototype</span><span class="PUNC">=</span><span class="NAME">proto</span><span class="PUNC">;</span><span class="NAME">self.substance.prototype.$super</span><span class="PUNC">=</span><span class="NAME">$super</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.include</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">module</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>  5</span> </span><span class="NAME">overwrite</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">module</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">overwrite</span><span class="PUNC">||</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">module</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.getter</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="NAME">func</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">self.substance.prototype</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"__defineGetter__"</span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">)</span><span class="NAME">p.__defineGetter__</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="NAME">func</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.setter</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="NAME">func</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">self.substance.prototype</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"__defineSetter__"</span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">)</span><span class="NAME">p.__defineSetter__</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="NAME">func</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.def</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">method</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">=</span><span class="NAME">getMethodName</span><span class="PUNC">(</span><span class="NAME">method</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">self.substance.prototype</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">wrap</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="NAME">method</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.defInObj</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">method</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">=</span><span class="NAME">getMethodName</span><span class="PUNC">(</span><span class="NAME">method</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>  6</span> </span><span class="NAME">method</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">FunctionPrototype</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">FunctionPrototype</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  7</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">InternalNamespacePrototype</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.nsName</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">this.use</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">func</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">self</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">oldDef</span><span class="PUNC">=</span><span class="NAME">global.proto</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">oldSingleton</span><span class="PUNC">=</span><span class="NAME">global.singleton</span><span class="PUNC">;</span><span class="NAME">global.proto</span><span class="PUNC">=</span><span class="NAME">this.proto</span><span class="PUNC">;</span><span class="NAME">global.singleton</span><span class="PUNC">=</span><span class="NAME">this.singleton</span><span class="PUNC">;</span><span class="NAME">func.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">global.proto</span><span class="PUNC">=</span><span class="NAME">oldDef</span><span class="PUNC">;</span><span class="NAME">global.singleton</span><span class="PUNC">=</span><span class="NAME">oldSingleton</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.proto</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">namedFunc</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tmpSelf</span><span class="PUNC">=</span><span class="NAME">self</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">)</span><span class="NAME">tmpSelf</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">=</span><span class="NAME">FunctionPrototype.getMethodName</span><span class="PUNC">(</span><span class="NAME">namedFunc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">tmpSelf</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">!=</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">alert</span><span class="PUNC">(</span><span class="STRN">"Warning: "</span><span class="PUNC">+</span><span class="NAME">tmpSelf.nsName</span><span class="PUNC">+</span><span class="STRN">"'s "</span><span class="PUNC">+</span><span class="NAME">name</span><span class="PUNC">+</span><span class="STRN">" was overwritten."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  8</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">global.debug</span><span class="PUNC">)</span><span class="NAME">tmpSelf</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">tmpSelf</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">eval</span><span class="PUNC">(</span><span class="STRN">"(function "</span><span class="PUNC">+</span><span class="NAME">name</span><span class="PUNC">+</span><span class="STRN">" () {})"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">tmpSelf</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">tmpSelf</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Function</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">proto</span><span class="PUNC">=</span><span class="NAME">tmpSelf</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">proto.gen</span><span class="PUNC">=</span><span class="NAME">FunctionPrototype.gen</span><span class="PUNC">;</span><span class="NAME">proto.def</span><span class="PUNC">=</span><span class="NAME">FunctionPrototype.defInObj</span><span class="PUNC">;</span><span class="NAME">proto.prototype.include</span><span class="PUNC">=</span><span class="NAME">FunctionPrototype.include</span><span class="PUNC">;</span><span class="NAME">proto.prototype.$class</span><span class="PUNC">=</span><span class="NAME">proto</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">old$$</span><span class="PUNC">=</span><span class="NAME">global.$$</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">oldInit</span><span class="PUNC">=</span><span class="NAME">global.init</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">oldEx</span><span class="PUNC">=</span><span class="NAME">global.ex</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">oldMeth</span><span class="PUNC">=</span><span class="NAME">global.def</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">oldGetter</span><span class="PUNC">=</span><span class="NAME">global.getter</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">oldSetter</span><span class="PUNC">=</span><span class="NAME">global.setter</span><span class="PUNC">;</span><span class="NAME">FunctionPrototype.substance</span><span class="PUNC">=</span><span class="NAME">proto</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  9</span> </span><span class="NAME">global.$$</span><span class="PUNC">=</span><span class="NAME">proto</span><span class="PUNC">;</span><span class="NAME">global.init</span><span class="PUNC">=</span><span class="NAME">namedFunc.init</span><span class="PUNC">=</span><span class="NAME">FunctionPrototype.init</span><span class="PUNC">;</span><span class="NAME">global.ex</span><span class="PUNC">=</span><span class="NAME">namedFunc.ex</span><span class="PUNC">=</span><span class="NAME">FunctionPrototype.ex</span><span class="PUNC">;</span><span class="NAME">global.def</span><span class="PUNC">=</span><span class="NAME">namedFunc.def</span><span class="PUNC">=</span><span class="NAME">FunctionPrototype.def</span><span class="PUNC">;</span><span class="NAME">global.getter</span><span class="PUNC">=</span><span class="NAME">FunctionPrototype.getter</span><span class="PUNC">;</span><span class="NAME">global.setter</span><span class="PUNC">=</span><span class="NAME">FunctionPrototype.setter</span><span class="PUNC">;</span><span class="NAME">namedFunc.call</span><span class="PUNC">(</span><span class="NAME">namedFunc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">global.$$</span><span class="PUNC">=</span><span class="NAME">old$$</span><span class="PUNC">;</span><span class="NAME">global.init</span><span class="PUNC">=</span><span class="NAME">oldInit</span><span class="PUNC">;</span><span class="NAME">global.ex</span><span class="PUNC">=</span><span class="NAME">oldEx</span><span class="PUNC">;</span><span class="NAME">global.def</span><span class="PUNC">=</span><span class="NAME">oldMeth</span><span class="PUNC">;</span><span class="NAME">global.getter</span><span class="PUNC">=</span><span class="NAME">oldGetter</span><span class="PUNC">;</span><span class="NAME">global.setter</span><span class="PUNC">=</span><span class="NAME">oldSetter</span><span class="PUNC">;</span><span class="NAME">proto.prototype.proto</span><span class="PUNC">=</span><span class="NAME">proto</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.singleton</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">namedFunc</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tmpSelf</span><span class="PUNC">=</span><span class="NAME">self</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">)</span><span class="NAME">tmpSelf</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 10</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">=</span><span class="NAME">FunctionPrototype.getMethodName</span><span class="PUNC">(</span><span class="NAME">namedFunc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">tmpSelf</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">!=</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">alert</span><span class="PUNC">(</span><span class="STRN">"Warning: "</span><span class="PUNC">+</span><span class="NAME">tmpSelf.nsName</span><span class="PUNC">+</span><span class="STRN">"'s "</span><span class="PUNC">+</span><span class="NAME">name</span><span class="PUNC">+</span><span class="STRN">" was overwritten."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">tmpSelf</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">eval</span><span class="PUNC">(</span><span class="STRN">"(function "</span><span class="PUNC">+</span><span class="NAME">name</span><span class="PUNC">+</span><span class="STRN">" () {})"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">tmpSelf</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">tmpSelf</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Function</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">proto</span><span class="PUNC">=</span><span class="NAME">tmpSelf</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">proto.getInstance</span><span class="PUNC">=</span><span class="NAME">FunctionPrototype.getInstance</span><span class="PUNC">;</span><span class="NAME">proto.def</span><span class="PUNC">=</span><span class="NAME">FunctionPrototype.defInObj</span><span class="PUNC">;</span><span class="NAME">proto.prototype.include</span><span class="PUNC">=</span><span class="NAME">FunctionPrototype.include</span><span class="PUNC">;</span><span class="NAME">proto.prototype.$class</span><span class="PUNC">=</span><span class="NAME">proto</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">old$</span><span class="PUNC">=</span><span class="NAME">global.$</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">old$$</span><span class="PUNC">=</span><span class="NAME">global.$$</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">oldInit</span><span class="PUNC">=</span><span class="NAME">global.init</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">oldEx</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 11</span> </span><span class="NAME">global.ex</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">oldMeth</span><span class="PUNC">=</span><span class="NAME">global.def</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">oldGetter</span><span class="PUNC">=</span><span class="NAME">global.getter</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">oldSetter</span><span class="PUNC">=</span><span class="NAME">global.setter</span><span class="PUNC">;</span><span class="NAME">FunctionPrototype.substance</span><span class="PUNC">=</span><span class="NAME">proto</span><span class="PUNC">;</span><span class="NAME">global.$</span><span class="PUNC">=</span><span class="NAME">namedFunc</span><span class="PUNC">;</span><span class="NAME">global.$$</span><span class="PUNC">=</span><span class="NAME">proto</span><span class="PUNC">;</span><span class="NAME">global.init</span><span class="PUNC">=</span><span class="NAME">namedFunc.init</span><span class="PUNC">=</span><span class="NAME">FunctionPrototype.init</span><span class="PUNC">;</span><span class="NAME">global.ex</span><span class="PUNC">=</span><span class="NAME">namedFunc.ex</span><span class="PUNC">=</span><span class="NAME">FunctionPrototype.ex</span><span class="PUNC">;</span><span class="NAME">global.def</span><span class="PUNC">=</span><span class="NAME">namedFunc.def</span><span class="PUNC">=</span><span class="NAME">FunctionPrototype.def</span><span class="PUNC">;</span><span class="NAME">global.getter</span><span class="PUNC">=</span><span class="NAME">FunctionPrototype.getter</span><span class="PUNC">;</span><span class="NAME">global.setter</span><span class="PUNC">=</span><span class="NAME">FunctionPrototype.setter</span><span class="PUNC">;</span><span class="NAME">namedFunc.call</span><span class="PUNC">(</span><span class="NAME">namedFunc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">global.$</span><span class="PUNC">=</span><span class="NAME">old$</span><span class="PUNC">;</span><span class="NAME">global.$$</span><span class="PUNC">=</span><span class="NAME">old$$</span><span class="PUNC">;</span><span class="NAME">global.init</span><span class="PUNC">=</span><span class="NAME">oldInit</span><span class="PUNC">;</span><span class="NAME">global.ex</span><span class="PUNC">=</span><span class="NAME">oldEx</span><span class="PUNC">;</span><span class="NAME">global.def</span><span class="PUNC">=</span><span class="NAME">oldMeth</span><span class="PUNC">;</span><span class="NAME">global.getter</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 12</span> </span><span class="NAME">oldGetter</span><span class="PUNC">;</span><span class="NAME">global.setter</span><span class="PUNC">=</span><span class="NAME">oldSetter</span><span class="PUNC">;</span><span class="NAME">proto.prototype.proto</span><span class="PUNC">=</span><span class="NAME">proto</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">internalNamespacePrototype</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">InternalNamespacePrototype</span><span class="PUNC">;</span><span class="NAME">Namespace</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">str</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ns</span><span class="PUNC">=</span><span class="NAME">str.split</span><span class="PUNC">(</span><span class="STRN">"."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">here</span><span class="PUNC">=</span><span class="NAME">global</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">ns.length</span><span class="PUNC">==</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">here</span><span class="PUNC">[</span><span class="NAME">str</span><span class="PUNC">]</span><span class="PUNC">!=</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">here</span><span class="PUNC">[</span><span class="NAME">str</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">here</span><span class="PUNC">[</span><span class="NAME">str</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">this.nsName</span><span class="PUNC">=</span><span class="NAME">str</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">ns.length</span><span class="PUNC">,</span><span class="NAME">ll</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">here</span><span class="PUNC">[</span><span class="NAME">ns</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="NAME">here</span><span class="PUNC">[</span><span class="NAME">ns</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">ns</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">name</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">"."</span><span class="PUNC">;</span><span class="NAME">name</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">ns</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">here</span><span class="PUNC">[</span><span class="NAME">ns</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">nsName</span><span class="PUNC">=</span><span class="NAME">name</span><span class="PUNC">;</span><span class="NAME">here</span><span class="PUNC">=</span><span class="NAME">here</span><span class="PUNC">[</span><span class="NAME">ns</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">here</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 13</span> </span><span class="NAME">Namespace.prototype</span><span class="PUNC">=</span><span class="NAME">internalNamespacePrototype</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 14</span> </span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_core</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">use</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ns</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Performer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">,</span><span class="NAME">func</span><span class="PUNC">,</span><span class="NAME">args</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.target</span><span class="PUNC">=</span><span class="NAME">target</span><span class="PUNC">;</span><span class="NAME">this.func</span><span class="PUNC">=</span><span class="NAME">func</span><span class="PUNC">;</span><span class="NAME">this.args</span><span class="PUNC">=</span><span class="NAME">args</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">perform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.func.apply</span><span class="PUNC">(</span><span class="NAME">this.target</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Utilitie</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">listen</span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">,</span><span class="NAME">type</span><span class="PUNC">,</span><span class="NAME">func</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">target.addEventListener</span><span class="PUNC">)</span><span class="NAME">target.addEventListener</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">func.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">target.attachEvent</span><span class="PUNC">)</span><span class="NAME">target.attachEvent</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">func.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">unlisten</span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 15</span> </span><span class="NAME">type</span><span class="PUNC">,</span><span class="NAME">func</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">target.removeEventListener</span><span class="PUNC">)</span><span class="NAME">target.removeEventListener</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">,</span><span class="NAME">func</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">target.attachEvent</span><span class="PUNC">)</span><span class="NAME">target.detachEvent</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">,</span><span class="NAME">func</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">singleton</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Main</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">util</span><span class="PUNC">=</span><span class="NAME">ns.Utilitie.gen</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">isIE</span><span class="PUNC">=</span><span class="NAME">navigator.userAgent.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">indexOf</span><span class="PUNC">(</span><span class="STRN">"msie"</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">util.listen</span><span class="PUNC">(</span><span class="NAME">global</span><span class="PUNC">,</span><span class="NAME">isIE</span><span class="PUNC">?</span><span class="STRN">"onload"</span><span class="PUNC">:</span><span class="STRN">"load"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">util.unlisten</span><span class="PUNC">(</span><span class="NAME">global</span><span class="PUNC">,</span><span class="NAME">isIE</span><span class="PUNC">?</span><span class="STRN">"onload"</span><span class="PUNC">:</span><span class="STRN">"load"</span><span class="PUNC">,</span><span class="NAME">arguments.callee</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">self.runner</span><span class="PUNC">)</span><span class="NAME">self.runner.call</span><span class="PUNC">(</span><span class="NAME">global</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">main</span><span class="PUNC">(</span><span class="NAME">runner</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.runner</span><span class="PUNC">=</span><span class="NAME">runner</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_core</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">use</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ns</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Notification</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="NAME">userData</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.name</span><span class="PUNC">=</span><span class="NAME">name</span><span class="PUNC">;</span><span class="NAME">this.userData</span><span class="PUNC">=</span><span class="NAME">userData</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.name</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getUserData</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.userData</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">singleton</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">NotificationCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">$$.targets</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">$$.addObserver</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">,</span><span class="NAME">func</span><span class="PUNC">,</span><span class="NAME">notifName</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">target</span><span class="PUNC">:</span><span class="NAME">target</span><span class="PUNC">,</span><span class="NAME">func</span><span class="PUNC">:</span><span class="NAME">func</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.targets.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">notifName</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">this.targets</span><span class="PUNC">[</span><span class="NAME">notifName</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">list</span><span class="PUNC">=</span><span class="NAME">this.targets</span><span class="PUNC">[</span><span class="NAME">notifName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">isAlreadyPushed</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 16</span> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">list.length</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">==</span><span class="NAME">list</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">target</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">isAlreadyPushed</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">isAlreadyPushed</span><span class="PUNC">)</span><span class="NAME">list.push</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">$$.removeObserver</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">,</span><span class="NAME">notifName</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">list</span><span class="PUNC">=</span><span class="NAME">this.targets</span><span class="PUNC">[</span><span class="NAME">notifName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">list.length</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">==</span><span class="NAME">list</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">target</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">list.splice</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">$$.postNotification</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">notification</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">list</span><span class="PUNC">=</span><span class="NAME">this.targets</span><span class="PUNC">[</span><span class="NAME">notification.name</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">list</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">list.length</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">=</span><span class="NAME">list</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">obj.func.call</span><span class="PUNC">(</span><span class="NAME">obj.target</span><span class="PUNC">,</span><span class="NAME">notification.object</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 17</span> </span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Timestamp</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.created</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">str</span><span class="PUNC">=</span><span class="STRN">"* Timestamp : "</span><span class="PUNC">+</span><span class="NAME">this.stamp</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">" msec"</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">str</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">stamp</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">this.created.getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Identifier</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">generate.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.IDs</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">generate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">check.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">this.id</span><span class="PUNC">*</span><span class="NAME">Math.random</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.$class.IDs.push</span><span class="PUNC">(</span><span class="NAME">this.id</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">check</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">numIDs</span><span class="PUNC">=</span><span class="NAME">this.$class.IDs.length</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 18</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">res</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">numIDs</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.$class.IDs</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">this.id</span><span class="PUNC">)</span><span class="NAME">res</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">res</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Wait</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">time</span><span class="PUNC">,</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.timer</span><span class="PUNC">=</span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">callback.call</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">time</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">callback</span><span class="PUNC">=</span><span class="NAME">callback</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">cancel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">clearTimeout</span><span class="PUNC">(</span><span class="NAME">this.timer</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Range</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">min</span><span class="PUNC">,</span><span class="NAME">max</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.min</span><span class="PUNC">=</span><span class="NAME">min</span><span class="PUNC">;</span><span class="NAME">this.max</span><span class="PUNC">=</span><span class="NAME">max</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">contains</span><span class="PUNC">(</span><span class="NAME">range</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.min</span><span class="PUNC">&lt;=</span><span class="NAME">range.min</span><span class="PUNC">&&</span><span class="NAME">range.max</span><span class="PUNC">&lt;=</span><span class="NAME">this.max</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">remap</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">,</span><span class="NAME">range</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">range.min</span><span class="PUNC">+</span><span class="NAME">range.length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.ratio</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 19</span> </span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.max</span><span class="PUNC">-</span><span class="NAME">this.min</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ratio</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">-</span><span class="NAME">this.min</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">this.length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Operation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">scope</span><span class="PUNC">,</span><span class="NAME">func</span><span class="PUNC">,</span><span class="NAME">args</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.scope</span><span class="PUNC">=</span><span class="NAME">scope</span><span class="PUNC">;</span><span class="NAME">this.func</span><span class="PUNC">=</span><span class="NAME">func</span><span class="PUNC">;</span><span class="NAME">this.args</span><span class="PUNC">=</span><span class="NAME">args</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">execute</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.func.apply</span><span class="PUNC">(</span><span class="NAME">this.scope</span><span class="PUNC">,</span><span class="NAME">this.args</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">OperationQueue</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.operations</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">push</span><span class="PUNC">(</span><span class="NAME">op</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.operations.push</span><span class="PUNC">(</span><span class="NAME">op</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.operations.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">execute</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.operations.each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">op</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">op.execute</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 20</span> </span><span class="NAME">singleton</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">System</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">args</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.FPS</span><span class="PUNC">=</span><span class="NUMB">30</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Recordable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.opq</span><span class="PUNC">=</span><span class="NAME">ns.OperationQueue.gen</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">rec</span><span class="PUNC">(</span><span class="NAME">op</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">op</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">caller</span><span class="PUNC">=</span><span class="NAME">arguments.callee.caller</span><span class="PUNC">;</span><span class="NAME">op</span><span class="PUNC">=</span><span class="NAME">ns.Operation.gen</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">caller</span><span class="PUNC">,</span><span class="NAME">caller.arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.opq.push</span><span class="PUNC">(</span><span class="NAME">op</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">playback</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.opq.execute</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.opq</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_platform</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">use</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ns</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">ns.nsName</span><span class="PUNC">+</span><span class="STRN">".browser"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">use</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">UserAgent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.ua</span><span class="PUNC">=</span><span class="NAME">navigator.userAgent.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">isIE</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.ua.indexOf</span><span class="PUNC">(</span><span class="STRN">"msie"</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">isIE6</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.ua.indexOf</span><span class="PUNC">(</span><span class="STRN">"msie 6"</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">isIE7</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.ua.indexOf</span><span class="PUNC">(</span><span class="STRN">"msie 7"</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">isIE8</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.ua.indexOf</span><span class="PUNC">(</span><span class="STRN">"msie 8"</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">isFireFox</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.ua.indexOf</span><span class="PUNC">(</span><span class="STRN">"firefox"</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="WHIT">
<span class='line'> 21</span> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">isSaferi</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.ua.indexOf</span><span class="PUNC">(</span><span class="STRN">"safari"</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">||</span><span class="NAME">this.isChrome</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="KEYW">false</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">isChrome</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.ua.indexOf</span><span class="PUNC">(</span><span class="STRN">"chrome"</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">isOpera</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.ua.indexOf</span><span class="PUNC">(</span><span class="STRN">"chrome"</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">isMobile</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.isiPhone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">this.isiPodTouch</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">this.isAndroid</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">isiPhone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.ua.indexOf</span><span class="PUNC">(</span><span class="STRN">"iphone"</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">isiPad</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.ua.indexOf</span><span class="PUNC">(</span><span class="STRN">"ipad"</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">isiPodTouch</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.ua.indexOf</span><span class="PUNC">(</span><span class="STRN">"ipod"</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">isAndroid</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.ua.indexOf</span><span class="PUNC">(</span><span class="STRN">"android"</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="WHIT">
<span class='line'> 22</span> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_events</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">use</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ns</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nsi</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">ns.nsName</span><span class="PUNC">+</span><span class="STRN">".internal"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">userAgent</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_platform</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">browser.UserAgent.gen</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">nsi.proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">EventTargetSet</span><span class="PUNC">(</span><span class="NAME">listener</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">listener</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.listener</span><span class="PUNC">=</span><span class="NAME">listener</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">EventDispatcher</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.observers</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.target</span><span class="PUNC">=</span><span class="NAME">target</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">addEventListener</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">,</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">list</span><span class="PUNC">=</span><span class="NAME">this.observers</span><span class="PUNC">[</span><span class="NAME">type</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">flg</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">list</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">numTargets</span><span class="PUNC">=</span><span class="NAME">list.length</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 23</span> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">numTargets</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">list</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="NAME">flg</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">flg</span><span class="PUNC">)</span><span class="NAME">list.push</span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.observers</span><span class="PUNC">[</span><span class="NAME">type</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.observers</span><span class="PUNC">[</span><span class="NAME">type</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">flg</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ae</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">,</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.addEventListener</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">,</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">removeEventListener</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">,</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">list</span><span class="PUNC">=</span><span class="NAME">this.observers</span><span class="PUNC">[</span><span class="NAME">type</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">numTargets</span><span class="PUNC">=</span><span class="NAME">list.length</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">numTargets</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">list</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="NAME">list</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">list.splice</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">re</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">,</span><span class="NAME">performer</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.removeEventListener</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">,</span><span class="NAME">performer</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 24</span> </span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">dispatchEvent</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">list</span><span class="PUNC">=</span><span class="NAME">this.observers</span><span class="PUNC">[</span><span class="NAME">event.type</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">list</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">numTargets</span><span class="PUNC">=</span><span class="NAME">list.length</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">numTargets</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">list</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">DOMEvent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">isIE</span><span class="PUNC">=</span><span class="NAME">userAgent.isIE</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">isIE</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">$$.INIT</span><span class="PUNC">=</span><span class="STRN">"onload"</span><span class="PUNC">;</span><span class="NAME">$$.LOAD</span><span class="PUNC">=</span><span class="STRN">"onload"</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">$$.INIT</span><span class="PUNC">=</span><span class="STRN">"load"</span><span class="PUNC">;</span><span class="NAME">$$.LOAD</span><span class="PUNC">=</span><span class="STRN">"load"</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">DOMMouseEvent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">isIE</span><span class="PUNC">=</span><span class="NAME">userAgent.isIE</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">isIE</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">$$.CLICK</span><span class="PUNC">=</span><span class="STRN">"onclick"</span><span class="PUNC">;</span><span class="NAME">$$.MOUSE_DOWN</span><span class="PUNC">=</span><span class="STRN">"onmousedown"</span><span class="PUNC">;</span><span class="NAME">$$.MOUSE_MOVE</span><span class="PUNC">=</span><span class="STRN">"onmousemove"</span><span class="PUNC">;</span><span class="NAME">$$.MOUSE_OUT</span><span class="PUNC">=</span><span class="STRN">"onmouseout"</span><span class="PUNC">;</span><span class="NAME">$$.MOUSE_OVER</span><span class="PUNC">=</span><span class="STRN">"onmouseover"</span><span class="PUNC">;</span><span class="NAME">$$.MOUSE_UP</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 25</span> </span><span class="STRN">"onmouseup"</span><span class="PUNC">;</span><span class="NAME">$$.MOSUE_WHEEL</span><span class="PUNC">=</span><span class="STRN">"onmousewheel"</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">$$.CLICK</span><span class="PUNC">=</span><span class="STRN">"click"</span><span class="PUNC">;</span><span class="NAME">$$.MOUSE_DOWN</span><span class="PUNC">=</span><span class="STRN">"mousedown"</span><span class="PUNC">;</span><span class="NAME">$$.MOUSE_MOVE</span><span class="PUNC">=</span><span class="STRN">"mousemove"</span><span class="PUNC">;</span><span class="NAME">$$.MOUSE_OUT</span><span class="PUNC">=</span><span class="STRN">"mouseout"</span><span class="PUNC">;</span><span class="NAME">$$.MOUSE_OVER</span><span class="PUNC">=</span><span class="STRN">"mouseover"</span><span class="PUNC">;</span><span class="NAME">$$.MOUSE_UP</span><span class="PUNC">=</span><span class="STRN">"mouseup"</span><span class="PUNC">;</span><span class="NAME">$$.MOSUE_WHEEL</span><span class="PUNC">=</span><span class="STRN">"mousewheel"</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">FLEvent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">,</span><span class="NAME">caller</span><span class="PUNC">,</span><span class="NAME">origin</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.type</span><span class="PUNC">=</span><span class="NAME">type</span><span class="PUNC">;</span><span class="NAME">this.origin</span><span class="PUNC">=</span><span class="NAME">origin</span><span class="PUNC">;</span><span class="NAME">this.currentTarget</span><span class="PUNC">=</span><span class="NAME">caller</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.origin.preventDefault</span><span class="PUNC">)</span><span class="NAME">this.origin.preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.origin.returnValue</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">stopPropagation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.origin.stopPropagation</span><span class="PUNC">)</span><span class="NAME">this.origin.stopPropagation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 26</span> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.origin.cancelBubbles</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.APP_LAUNCH</span><span class="PUNC">=</span><span class="STRN">"appLaunch"</span><span class="PUNC">;</span><span class="NAME">$$.COMPLETE</span><span class="PUNC">=</span><span class="STRN">"complete"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">FLMouseEvent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ex</span><span class="PUNC">(</span><span class="NAME">ns.FLEvent</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">,</span><span class="NAME">caller</span><span class="PUNC">,</span><span class="NAME">origin</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.$super</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">,</span><span class="NAME">caller</span><span class="PUNC">,</span><span class="NAME">origin</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.CLICK</span><span class="PUNC">=</span><span class="STRN">"click"</span><span class="PUNC">;</span><span class="NAME">$$.DOUBLE_CLICK</span><span class="PUNC">=</span><span class="STRN">"doubleclick"</span><span class="PUNC">;</span><span class="NAME">$$.MOUSE_DOWN</span><span class="PUNC">=</span><span class="STRN">"mousedown"</span><span class="PUNC">;</span><span class="NAME">$$.MOUSE_MOVE</span><span class="PUNC">=</span><span class="STRN">"mousemove"</span><span class="PUNC">;</span><span class="NAME">$$.MOUSE_OUT</span><span class="PUNC">=</span><span class="STRN">"mouseout"</span><span class="PUNC">;</span><span class="NAME">$$.MOUSE_OVER</span><span class="PUNC">=</span><span class="STRN">"mouseover"</span><span class="PUNC">;</span><span class="NAME">$$.MOUSE_UP</span><span class="PUNC">=</span><span class="STRN">"mouseup"</span><span class="PUNC">;</span><span class="NAME">$$.MOUSE_WHEEL</span><span class="PUNC">=</span><span class="STRN">"mousewheel"</span><span class="PUNC">;</span><span class="NAME">$$.ROLL_OUT</span><span class="PUNC">=</span><span class="STRN">"rollout"</span><span class="PUNC">;</span><span class="NAME">$$.ROLL_OVER</span><span class="PUNC">=</span><span class="STRN">"rollover"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_geom</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">use</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ns</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Point</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">y</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ns.Point.gen</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="NAME">p.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="NAME">p.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ns.Point.gen</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">distance</span><span class="PUNC">(</span><span class="NAME">p1</span><span class="PUNC">,</span><span class="NAME">p2</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dx</span><span class="PUNC">=</span><span class="NAME">p1.x</span><span class="PUNC">-</span><span class="NAME">p2.x</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dy</span><span class="PUNC">=</span><span class="NAME">p1.y</span><span class="PUNC">-</span><span class="NAME">p2.y</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">dx</span><span class="PUNC">*</span><span class="NAME">dx</span><span class="PUNC">+</span><span class="NAME">dy</span><span class="PUNC">*</span><span class="NAME">dy</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">equals</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">==</span><span class="NAME">p.x</span><span class="PUNC">&&</span><span class="NAME">this.y</span><span class="PUNC">==</span><span class="NAME">p.y</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">offset</span><span class="PUNC">(</span><span class="NAME">dx</span><span class="PUNC">,</span><span class="NAME">dy</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">dx</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">dy</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">subtract</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ns.Point.gen</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'> 27</span> </span><span class="NAME">p.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">-</span><span class="NAME">p.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">interpolate</span><span class="PUNC">(</span><span class="NAME">p1</span><span class="PUNC">,</span><span class="NAME">p2</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dx</span><span class="PUNC">=</span><span class="NAME">p2.x</span><span class="PUNC">-</span><span class="NAME">p1.x</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dy</span><span class="PUNC">=</span><span class="NAME">p2.y</span><span class="PUNC">-</span><span class="NAME">p1.y</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tx</span><span class="PUNC">=</span><span class="NAME">p1.x</span><span class="PUNC">+</span><span class="NAME">dx</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ty</span><span class="PUNC">=</span><span class="NAME">p1.y</span><span class="PUNC">+</span><span class="NAME">dy</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ns.Point.gen</span><span class="PUNC">(</span><span class="NAME">tx</span><span class="PUNC">,</span><span class="NAME">ty</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">polar</span><span class="PUNC">(</span><span class="NAME">length</span><span class="PUNC">,</span><span class="NAME">radian</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ns.Point.gen</span><span class="PUNC">(</span><span class="NAME">length</span><span class="PUNC">*</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">radian</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">length</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">radian</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Rectangle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">y</span><span class="PUNC">;</span><span class="NAME">this.width</span><span class="PUNC">=</span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.height</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ns.Rectangle.gen</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">this.width</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 28</span> </span><span class="NAME">this.height</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">contains</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">&lt;</span><span class="NAME">x</span><span class="PUNC">&&</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="NAME">this.width</span><span class="PUNC">></span><span class="NAME">x</span><span class="PUNC">&&</span><span class="NAME">this.y</span><span class="PUNC">&lt;</span><span class="NAME">y</span><span class="PUNC">&&</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="NAME">this.height</span><span class="PUNC">></span><span class="NAME">y</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">containsPoint</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.contains</span><span class="PUNC">(</span><span class="NAME">p.x</span><span class="PUNC">,</span><span class="NAME">p.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">containsRect</span><span class="PUNC">(</span><span class="NAME">rect</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.contains</span><span class="PUNC">(</span><span class="NAME">rect.x</span><span class="PUNC">,</span><span class="NAME">rect.y</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.contains</span><span class="PUNC">(</span><span class="NAME">rect.x</span><span class="PUNC">+</span><span class="NAME">rect.width</span><span class="PUNC">,</span><span class="NAME">rect.y</span><span class="PUNC">+</span><span class="NAME">rect.height</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">equals</span><span class="PUNC">(</span><span class="NAME">rect</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">==</span><span class="NAME">rect.x</span><span class="PUNC">&&</span><span class="NAME">this.y</span><span class="PUNC">==</span><span class="NAME">rect.y</span><span class="PUNC">&&</span><span class="NAME">this.width</span><span class="PUNC">==</span><span class="NAME">rect.width</span><span class="PUNC">&&</span><span class="NAME">this.height</span><span class="PUNC">==</span><span class="NAME">rect.height</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">inflate</span><span class="PUNC">(</span><span class="NAME">dx</span><span class="PUNC">,</span><span class="NAME">dy</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.width</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">dx</span><span class="PUNC">;</span><span class="NAME">this.height</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">dy</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">inflatePoint</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.width</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 29</span> </span><span class="NAME">p.x</span><span class="PUNC">;</span><span class="NAME">this.height</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.y</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">intersection</span><span class="PUNC">(</span><span class="NAME">rect</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">ns.Rectangle.gen</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.x</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">rect.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.y</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">rect.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.getRight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NAME">rect.getRight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">this.getRight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">rect.x</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">rect.getRight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">this.x</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.getBottom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NAME">rect.getBottom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.getBottom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">rect.y</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">rect.getBottom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">this.y</span><span class="PUNC">;</span><span class="NAME">r.width</span><span class="PUNC">=</span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">r.height</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">r.width</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">r.height</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">intersect</span><span class="PUNC">(</span><span class="NAME">rect</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.intersection</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">offset</span><span class="PUNC">(</span><span class="NAME">dx</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 30</span> </span><span class="NAME">dy</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">dx</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">dy</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">offsetPoint</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.y</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">union</span><span class="PUNC">(</span><span class="NAME">rect</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">intersection</span><span class="PUNC">=</span><span class="NAME">this.intersection</span><span class="PUNC">(</span><span class="NAME">rect</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">ns.Rectangle.gen</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.x</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">rect.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.y</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">rect.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.width</span><span class="PUNC">=</span><span class="NAME">this.width</span><span class="PUNC">+</span><span class="NAME">rect.width</span><span class="PUNC">-</span><span class="NAME">intersection.width</span><span class="PUNC">;</span><span class="NAME">r.height</span><span class="PUNC">=</span><span class="NAME">this.height</span><span class="PUNC">+</span><span class="NAME">rect.height</span><span class="PUNC">-</span><span class="NAME">intersection.height</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getBottom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="NAME">this.height</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getBottomRight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ns.Point.gen</span><span class="PUNC">(</span><span class="NAME">this.getRight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.getBottom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getRight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'> 31</span> </span><span class="NAME">this.width</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ns.Point.gen</span><span class="PUNC">(</span><span class="NAME">this.width</span><span class="PUNC">,</span><span class="NAME">this.height</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getTopLeft</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ns.Point.gen</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Matrix</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">tx</span><span class="PUNC">,</span><span class="NAME">ty</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.tx</span><span class="PUNC">=</span><span class="NAME">tx</span><span class="PUNC">;</span><span class="NAME">this.ty</span><span class="PUNC">=</span><span class="NAME">ty</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ns.Matrix.gen</span><span class="PUNC">(</span><span class="NAME">this.a</span><span class="PUNC">,</span><span class="NAME">this.b</span><span class="PUNC">,</span><span class="NAME">this.c</span><span class="PUNC">,</span><span class="NAME">this.d</span><span class="PUNC">,</span><span class="NAME">this.tx</span><span class="PUNC">,</span><span class="NAME">this.ty</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">cancat</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.d</span><span class="PUNC">,</span><span class="NAME">tx</span><span class="PUNC">=</span><span class="NAME">this.tx</span><span class="PUNC">,</span><span class="NAME">ty</span><span class="PUNC">=</span><span class="NAME">this.ty</span><span class="PUNC">;</span><span class="NAME">this.a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">m.a</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">m.b</span><span class="PUNC">;</span><span class="NAME">this.c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">m.c</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">m.d</span><span class="PUNC">;</span><span class="NAME">this.tx</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">m.tx</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">m.ty</span><span class="PUNC">+</span><span class="NAME">tx</span><span class="PUNC">;</span><span class="NAME">this.b</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 32</span> </span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">m.a</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">m.b</span><span class="PUNC">;</span><span class="NAME">this.d</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">m.c</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">m.d</span><span class="PUNC">;</span><span class="NAME">this.ty</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">m.tx</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">m.ty</span><span class="PUNC">+</span><span class="NAME">ty</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">identity</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.a</span><span class="PUNC">=</span><span class="NAME">this.d</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.b</span><span class="PUNC">=</span><span class="NAME">this.c</span><span class="PUNC">=</span><span class="NAME">this.tx</span><span class="PUNC">=</span><span class="NAME">this.ty</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">rotate</span><span class="PUNC">(</span><span class="NAME">radian</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">rot</span><span class="PUNC">=</span><span class="NAME">ns.Matrix.gen</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">radian</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">radian</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">rot.a</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">rot.b</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">rot.c</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">rot.d</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.concat</span><span class="PUNC">(</span><span class="NAME">rot</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">scale</span><span class="PUNC">(</span><span class="NAME">scl</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">ns.Matrix.gen</span><span class="PUNC">(</span><span class="NAME">scl</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">scl</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.concat</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">translate</span><span class="PUNC">(</span><span class="NAME">dx</span><span class="PUNC">,</span><span class="NAME">dy</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.tx</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">dx</span><span class="PUNC">;</span><span class="NAME">this.ty</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">dy</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_app</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">use</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ns</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">singleton</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Application</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nse</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_events</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">ex</span><span class="PUNC">(</span><span class="NAME">nse.EventDispatcher</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">this.mouseX</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.mouseY</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.userAgent</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_platform</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">browser.UserAgent.gen</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nscore</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_core</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">util</span><span class="PUNC">=</span><span class="NAME">nscore.Utilitie.gen</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">isIE</span><span class="PUNC">=</span><span class="NAME">this.userAgent.isIE</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">util.listen</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">,</span><span class="NAME">isIE</span><span class="PUNC">?</span><span class="STRN">"onmousemove"</span><span class="PUNC">:</span><span class="STRN">"mousemove"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">mouseMove</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">isIE</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.mouseX</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 33</span> </span><span class="NAME">mouseMove.clientX</span><span class="PUNC">;</span><span class="NAME">this.mouseY</span><span class="PUNC">=</span><span class="NAME">mouseMove.clientY</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">document.body</span><span class="PUNC">)</span><span class="NAME">this.mouseY</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">document.body.scrollTop</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.mouseX</span><span class="PUNC">=</span><span class="NAME">mouseMove.clientX</span><span class="PUNC">;</span><span class="NAME">this.mouseY</span><span class="PUNC">=</span><span class="NAME">mouseMove.clientY</span><span class="PUNC">+</span><span class="NAME">document.documentElement.scrollTop</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_tween</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">use</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ns</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Interpolator</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">to</span><span class="PUNC">,</span><span class="NAME">from</span><span class="PUNC">,</span><span class="NAME">step</span><span class="PUNC">,</span><span class="NAME">easing</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.values</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">to</span><span class="PUNC">-</span><span class="NAME">from</span><span class="PUNC">;</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">&lt;</span><span class="NAME">step</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">easing.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">from</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">step</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.values.push</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Animator</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">delay</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.delay</span><span class="PUNC">=</span><span class="NAME">delay</span><span class="PUNC">;</span><span class="NAME">this.next</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">tween</span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">,</span><span class="NAME">style</span><span class="PUNC">,</span><span class="NAME">to</span><span class="PUNC">,</span><span class="NAME">step</span><span class="PUNC">,</span><span class="NAME">easing</span><span class="PUNC">,</span><span class="NAME">delay</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">this.delay</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">delay</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">cnt</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">styleValue</span><span class="PUNC">=</span><span class="NAME">target</span><span class="PUNC">[</span><span class="NAME">style</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">from</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">styleValue</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 34</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">interp</span><span class="PUNC">=</span><span class="NAME">ns.Interpolator.gen</span><span class="PUNC">(</span><span class="NAME">to</span><span class="PUNC">,</span><span class="NAME">from</span><span class="PUNC">,</span><span class="NAME">step</span><span class="PUNC">,</span><span class="NAME">easing</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">values</span><span class="PUNC">=</span><span class="NAME">interp.values</span><span class="PUNC">;</span><span class="NAME">step</span><span class="PUNC">=</span><span class="NAME">step</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">timerID</span><span class="PUNC">=</span><span class="NAME">setInterval</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">target</span><span class="PUNC">[</span><span class="NAME">style</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">values</span><span class="PUNC">[</span><span class="NAME">cnt</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">self.upFunc</span><span class="PUNC">)</span><span class="NAME">self.upFunc.call</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">cnt</span><span class="PUNC">>=</span><span class="NAME">step</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">clearInterval</span><span class="PUNC">(</span><span class="NAME">timerID</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">self.cbFunc</span><span class="PUNC">)</span><span class="NAME">self.cbFunc.call</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">target.rendering</span><span class="PUNC">)</span><span class="NAME">target.rendering</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">cnt</span><span class="PUNC">++</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="NAME">E3</span><span class="PUNC">/</span><span class="NUMB">60</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">this.delay</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.next</span><span class="PUNC">=</span><span class="NAME">ns.Animator.gen</span><span class="PUNC">(</span><span class="NAME">this.delay</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="NAME">E3</span><span class="PUNC">/</span><span class="NUMB">60</span><span class="PUNC">*</span><span class="NAME">step</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">singleton</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Bounce</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeIn</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NUMB">2.75</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NUMB">7.5625</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'> 35</span> </span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">&lt;</span><span class="NUMB">2</span><span class="PUNC">/</span><span class="NUMB">2.75</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">7.5625</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">1.5</span><span class="PUNC">/</span><span class="NUMB">2.75</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NUMB">0.75</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">&lt;</span><span class="NUMB">2.5</span><span class="PUNC">/</span><span class="NUMB">2.75</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">7.5625</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">2.25</span><span class="PUNC">/</span><span class="NUMB">2.75</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NUMB">0.9375</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">7.5625</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">2.625</span><span class="PUNC">/</span><span class="NUMB">2.75</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NUMB">0.984375</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeOut</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NUMB">2.75</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">*</span><span class="NUMB">7.5625</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">&lt;</span><span class="NUMB">2</span><span class="PUNC">/</span><span class="NUMB">2.75</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">7.5625</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">1.5</span><span class="PUNC">/</span><span class="NUMB">2.75</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NUMB">0.75</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">&lt;</span><span class="NUMB">2.5</span><span class="PUNC">/</span><span class="NUMB">2.75</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">7.5625</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">2.25</span><span class="PUNC">/</span><span class="NUMB">2.75</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NUMB">0.9375</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">7.5625</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">2.625</span><span class="PUNC">/</span><span class="NUMB">2.75</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NUMB">0.984375</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeInOut</span><span class="PUNC">(</span><span class="NAME">args</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">1.70158</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NUMB">1.525</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'> 36</span> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NUMB">1.525</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">singleton</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Circ</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeIn</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeOut</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeInOut</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">singleton</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Cubic</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeIn</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeOut</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 37</span> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeInOut</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NUMB">1</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">singleton</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Elastic</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeIn</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">p</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NUMB">0.3</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">/</span><span class="NUMB">4</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Math.asin</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeOut</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">p</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 38</span> </span><span class="NAME">d</span><span class="PUNC">*</span><span class="NUMB">0.3</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">/</span><span class="NUMB">4</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Math.asin</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">10</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeInOut</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">p</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NUMB">0.3</span><span class="PUNC">*</span><span class="NUMB">1.5</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">/</span><span class="NUMB">4</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Math.asin</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">&lt;</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">-</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">10</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NUMB">0.5</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">singleton</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Expo</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 39</span> </span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeIn</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeOut</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">==</span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">10</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeInOut</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">==</span><span class="NAME">d</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">10</span><span class="PUNC">*</span><span class="PUNC">--</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">singleton</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Qaud</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeIn</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeOut</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeInOut</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 40</span> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">--</span><span class="NAME">t</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">singleton</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Quart</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeIn</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeOut</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeInOut</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">singleton</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Quintic</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeIn</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeOut</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="WHIT">
<span class='line'> 41</span> </span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeInOut</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">singleton</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Sine</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeIn</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeOut</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">easeInOut</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">Math.PI</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_net</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">use</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ns</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">URL</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.url</span><span class="PUNC">=</span><span class="NAME">url</span><span class="PUNC">;</span><span class="NAME">this.scheme</span><span class="PUNC">=</span><span class="NAME">this.port</span><span class="PUNC">=</span><span class="NAME">this.user</span><span class="PUNC">=</span><span class="NAME">this.pass</span><span class="PUNC">=</span><span class="NAME">this.path</span><span class="PUNC">=</span><span class="NAME">this.query</span><span class="PUNC">=</span><span class="NAME">this.fragment</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">this.generate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">generate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">this.reg.exec</span><span class="PUNC">(</span><span class="NAME">this.url</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.fields</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">value</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NAME">this.fields</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">value</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.reg</span><span class="PUNC">=</span><span class="REGX">/^((\w+):\/\/)?((\w+):?(\w+)?@)?([^\/\?:]+):?(\d+)?(\/?[^\?#]+)?\??([^#]+)?#?([^#]*)/</span><span class="PUNC">;</span><span class="NAME">$$.fields</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="STRN">"scheme"</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="STRN">"host"</span><span class="PUNC">:</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="STRN">"port"</span><span class="PUNC">:</span><span class="NUMB">7</span><span class="PUNC">,</span><span class="STRN">"user"</span><span class="PUNC">:</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 42</span> </span><span class="STRN">"pass"</span><span class="PUNC">:</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="STRN">"path"</span><span class="PUNC">:</span><span class="NUMB">8</span><span class="PUNC">,</span><span class="STRN">"query"</span><span class="PUNC">:</span><span class="NUMB">9</span><span class="PUNC">,</span><span class="STRN">"fragment"</span><span class="PUNC">:</span><span class="NUMB">10</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">URLRequest</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">urlString</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.url</span><span class="PUNC">=</span><span class="NAME">urlString</span><span class="PUNC">;</span><span class="NAME">this.httpMethod</span><span class="PUNC">=</span><span class="STRN">"GET"</span><span class="PUNC">;</span><span class="NAME">this.httpHeader</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.httpBody</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.httpHeader.contentType</span><span class="PUNC">=</span><span class="STRN">"application/x-www-form-urlencoded;charset=UTF-8"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">URLLoader</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nse</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_events</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">ex</span><span class="PUNC">(</span><span class="NAME">nse.EventDispatcher</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.currentXHR</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.data</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">this.readyStateCallback</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">self.currentXHR.readyState</span><span class="PUNC">==</span><span class="NAME">ns.URLLoader.DONE</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">self.data</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 43</span> </span><span class="NAME">self.currentXHR.responseText</span><span class="PUNC">;</span><span class="NAME">self.dispatchEvent</span><span class="PUNC">(</span><span class="NAME">nse.FLEvent.gen</span><span class="PUNC">(</span><span class="NAME">nse.FLEvent.COMPLETE</span><span class="PUNC">,</span><span class="NAME">self</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">||</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">load</span><span class="PUNC">(</span><span class="NAME">req</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">xhr</span><span class="PUNC">=</span><span class="NAME">this.currentXHR</span><span class="PUNC">=</span><span class="NAME">this.generateXHR</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">xhr.onreadystatechange</span><span class="PUNC">=</span><span class="NAME">this.readyStateCallback</span><span class="PUNC">;</span><span class="NAME">xhr.open</span><span class="PUNC">(</span><span class="NAME">req.httpMethod</span><span class="PUNC">,</span><span class="NAME">req.url</span><span class="PUNC">,</span><span class="KEYW">true</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">xhr.setRequestHeader</span><span class="PUNC">(</span><span class="STRN">"Content-type"</span><span class="PUNC">,</span><span class="NAME">req.httpHeader.contentType</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">xhr.send</span><span class="PUNC">(</span><span class="NAME">req.httpBody</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">generateXHR</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">xhr</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">global.XMLHttpRequest</span><span class="PUNC">!=</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">xhr</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XMLHttpRequest</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">global.ActiveXObject</span><span class="PUNC">)</span><span class="NAME">xhr</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ActiveXObject</span><span class="PUNC">(</span><span class="STRN">"Microsoft.XMLHTTP"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 44</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">xhr</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.UNSET</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">$$.OPENED</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">$$.HEADERS_RECEIVED</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">$$.LOADING</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">$$.DONE</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_display</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">use</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ns</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nsc</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_core</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nse</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_events</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nsg</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_geom</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">app</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_app</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">Application.getInstance</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">DisplayObject</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ex</span><span class="PUNC">(</span><span class="NAME">nse.EventDispatcher</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">domElement</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.domElement</span><span class="PUNC">=</span><span class="NAME">domElement</span><span class="PUNC">;</span><span class="NAME">this.parent</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.alpha</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.domElement.style.left.replace</span><span class="PUNC">(</span><span class="STRN">"px"</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">setX</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.domElement.style.marginLeft</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 45</span> </span><span class="NAME">val</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.domElement.style.top.replace</span><span class="PUNC">(</span><span class="STRN">"px"</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">setY</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.domElement.style.top</span><span class="PUNC">=</span><span class="NAME">val</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.domElement.offsetWidth</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">setWidth</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.domElement.style.width</span><span class="PUNC">=</span><span class="NAME">val</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.domElement.offsetHeight</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">setHeight</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.domElement.style.height</span><span class="PUNC">=</span><span class="NAME">val</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getMouseX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">app.mouseX</span><span class="PUNC">-</span><span class="NAME">this.getGlobalX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getMouseY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">app.mouseX.mouseY</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'> 46</span> </span><span class="NAME">this.getGlobalY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getGlobalX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tmpX</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">tmpX</span><span class="PUNC">=</span><span class="NAME">this.domElement.offsetLeft</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">pa</span><span class="PUNC">=</span><span class="NAME">this.domElement.offsetParent</span><span class="PUNC">;</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">pa</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">tmpX</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">pa.offsetLeft</span><span class="PUNC">;</span><span class="NAME">pa</span><span class="PUNC">=</span><span class="NAME">pa.offsetParent</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">tmpX</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getGlobalY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tmpY</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">tmpY</span><span class="PUNC">=</span><span class="NAME">this.domElement.offsetTop</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">pa</span><span class="PUNC">=</span><span class="NAME">this.domElement.offsetParent</span><span class="PUNC">;</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">pa</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">tmpY</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">pa.offsetTop</span><span class="PUNC">;</span><span class="NAME">pa</span><span class="PUNC">=</span><span class="NAME">pa.offsetParent</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">tmpY</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getBounds</span><span class="PUNC">(</span><span class="NAME">targetCoordinateSpace</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">targetXAtGlobal</span><span class="PUNC">=</span><span class="NAME">targetCoordinateSpace.getGlobalX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">targetYAtGlobal</span><span class="PUNC">=</span><span class="NAME">targetCoordinateSpace.getGlobalY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 47</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">thisXAtGlobal</span><span class="PUNC">=</span><span class="NAME">this.getGlobalX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">thisYAtGlobal</span><span class="PUNC">=</span><span class="NAME">this.getGlobalY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">nsg.Rectangle.gen</span><span class="PUNC">(</span><span class="NAME">thisXAtGlobal</span><span class="PUNC">-</span><span class="NAME">targetXAtGlobal</span><span class="PUNC">,</span><span class="NAME">thisYAtGlobal</span><span class="PUNC">-</span><span class="NAME">targetXAtGlobal</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getRect</span><span class="PUNC">(</span><span class="NAME">targetCoordinateSpace</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getBounds</span><span class="PUNC">(</span><span class="NAME">targetCoordinateSpace</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">globalToLocal</span><span class="PUNC">(</span><span class="NAME">globalP</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">nsg.Point.gen</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="NAME">globalP.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="NAME">globalP.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">paint</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">=</span><span class="NAME">this.domElement.style</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ua</span><span class="PUNC">=</span><span class="NAME">app.userAgent</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">ua.isIE</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">style.filter</span><span class="PUNC">=</span><span class="STRN">"alpha(opacity="</span><span class="PUNC">+</span><span class="NAME">this.alpha</span><span class="PUNC">*</span><span class="NUMB">100</span><span class="PUNC">+</span><span class="STRN">")"</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">style.opacity</span><span class="PUNC">=</span><span class="NAME">this.alpha.toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 48</span> </span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">rendering</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.paint</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">removeFromSuperview</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.domElement.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">this.de</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">InteractiveObject</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ex</span><span class="PUNC">(</span><span class="NAME">ns.DisplayObject</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">domElement</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.domElement</span><span class="PUNC">=</span><span class="NAME">domElement</span><span class="PUNC">;</span><span class="NAME">this.setEvents</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getUseHandCursor</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.domElement.style.cursor</span><span class="PUNC">==</span><span class="STRN">"pointer"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">setUseHandCursor</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="NAME">this.domElement.style.cursor</span><span class="PUNC">=</span><span class="STRN">"pointer"</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.domElement.style.cursor</span><span class="PUNC">=</span><span class="STRN">"default"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">setEvents</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 49</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">nsc.Utilitie.gen</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">isOvered</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">g.listen</span><span class="PUNC">(</span><span class="NAME">this.domElement</span><span class="PUNC">,</span><span class="NAME">nse.DOMMouseEvent.MOUSE_OVER</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">isOvered</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">isOvered</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="NAME">self.dispatchEvent</span><span class="PUNC">(</span><span class="NAME">nse.FLMouseEvent.gen</span><span class="PUNC">(</span><span class="NAME">nse.FLMouseEvent.ROLL_OVER</span><span class="PUNC">,</span><span class="NAME">self</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.listen</span><span class="PUNC">(</span><span class="NAME">this.domElement</span><span class="PUNC">,</span><span class="NAME">nse.DOMMouseEvent.MOUSE_OUT</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">isOvered</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">rect</span><span class="PUNC">=</span><span class="NAME">nsg.Rectangle.gen</span><span class="PUNC">(</span><span class="NAME">self.getGlobalX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">self.getGlobalY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">self.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">self.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">isOvered</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">isOvered</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">self.dispatchEvent</span><span class="PUNC">(</span><span class="NAME">nse.FLMouseEvent.gen</span><span class="PUNC">(</span><span class="NAME">nse.FLMouseEvent.ROLL_OUT</span><span class="PUNC">,</span><span class="NAME">self</span><span class="PUNC">,</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 50</span> </span><span class="NAME">g.listen</span><span class="PUNC">(</span><span class="NAME">this.domElement</span><span class="PUNC">,</span><span class="NAME">nse.DOMMouseEvent.MOUSE_OVER</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">mOver</span><span class="PUNC">=</span><span class="NAME">nse.FLMouseEvent.gen</span><span class="PUNC">(</span><span class="NAME">nse.FLMouseEvent.MOUSE_OVER</span><span class="PUNC">,</span><span class="NAME">self</span><span class="PUNC">,</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">mOver.target</span><span class="PUNC">=</span><span class="NAME">evt.target</span><span class="PUNC">||</span><span class="NAME">evt.srcElement</span><span class="PUNC">;</span><span class="NAME">self.dispatchEvent</span><span class="PUNC">(</span><span class="NAME">mOver</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.listen</span><span class="PUNC">(</span><span class="NAME">this.domElement</span><span class="PUNC">,</span><span class="NAME">nse.DOMMouseEvent.MOUSE_OUT</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">mOut</span><span class="PUNC">=</span><span class="NAME">nse.FLMouseEvent.gen</span><span class="PUNC">(</span><span class="NAME">nse.FLMouseEvent.MOUSE_OUT</span><span class="PUNC">,</span><span class="NAME">self</span><span class="PUNC">,</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">mOut.target</span><span class="PUNC">=</span><span class="NAME">evt.target</span><span class="PUNC">||</span><span class="NAME">evt.srcElement</span><span class="PUNC">;</span><span class="NAME">self.dispatchEvent</span><span class="PUNC">(</span><span class="NAME">mOut</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.listen</span><span class="PUNC">(</span><span class="NAME">this.domElement</span><span class="PUNC">,</span><span class="NAME">nse.DOMMouseEvent.CLICK</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">click</span><span class="PUNC">=</span><span class="NAME">nse.FLMouseEvent.gen</span><span class="PUNC">(</span><span class="NAME">nse.FLMouseEvent.CLICK</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 51</span> </span><span class="NAME">self</span><span class="PUNC">,</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">click.target</span><span class="PUNC">=</span><span class="NAME">evt.target</span><span class="PUNC">||</span><span class="NAME">evt.srcElement</span><span class="PUNC">;</span><span class="NAME">self.dispatchEvent</span><span class="PUNC">(</span><span class="NAME">click</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.listen</span><span class="PUNC">(</span><span class="NAME">this.domElement</span><span class="PUNC">,</span><span class="NAME">nse.DOMMouseEvent.MOUSE_DOWN</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">down</span><span class="PUNC">=</span><span class="NAME">nse.FLMouseEvent.gen</span><span class="PUNC">(</span><span class="NAME">nse.FLMouseEvent.MOUSE_DOWN</span><span class="PUNC">,</span><span class="NAME">self</span><span class="PUNC">,</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">down.target</span><span class="PUNC">=</span><span class="NAME">evt.target</span><span class="PUNC">||</span><span class="NAME">evt.srcElement</span><span class="PUNC">;</span><span class="NAME">self.dispatchEvent</span><span class="PUNC">(</span><span class="NAME">down</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.listen</span><span class="PUNC">(</span><span class="NAME">this.domElement</span><span class="PUNC">,</span><span class="NAME">nse.DOMMouseEvent.MOUSE_UP</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">up</span><span class="PUNC">=</span><span class="NAME">nse.FLMouseEvent.gen</span><span class="PUNC">(</span><span class="NAME">nse.FLMouseEvent.MOUSE_UP</span><span class="PUNC">,</span><span class="NAME">self</span><span class="PUNC">,</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">up.target</span><span class="PUNC">=</span><span class="NAME">evt.target</span><span class="PUNC">||</span><span class="NAME">evt.srcElement</span><span class="PUNC">;</span><span class="NAME">self.dispatchEvent</span><span class="PUNC">(</span><span class="NAME">up</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_ui</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">use</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ns</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nsd</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_display</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Label</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ex</span><span class="PUNC">(</span><span class="NAME">nsd.DisplayObject</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">textElement</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ns.Label.superClass.initialize.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">textElement</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.hasInnerHTML</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">textElement.innerHTML</span><span class="PUNC">==</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">this.hasInnerHTML</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">this.text</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.hasInnerHTML</span><span class="PUNC">)</span><span class="NAME">this.text</span><span class="PUNC">=</span><span class="NAME">textElement.innerHTML</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.text</span><span class="PUNC">=</span><span class="NAME">textElement.textContent</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">rendering</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">box</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">box.style.position</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 52</span> </span><span class="STRN">"absolute"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">clone</span><span class="PUNC">=</span><span class="NAME">this.domElement.cloneNode</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">box.appendChild</span><span class="PUNC">(</span><span class="NAME">clone</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">document.body.appendChild</span><span class="PUNC">(</span><span class="NAME">box</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">this.text</span><span class="PUNC">;</span><span class="NAME">clone.style.fontSize</span><span class="PUNC">=</span><span class="NAME">this.domElement.style.fontSize</span><span class="PUNC">;</span><span class="NAME">this.setCloneText</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">box.style.width</span><span class="PUNC">=</span><span class="NAME">this.targetWidth</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">box.offsetHeight</span><span class="PUNC">></span><span class="NAME">this.targetHeight</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t.length</span><span class="PUNC">==</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.setCloneText</span><span class="PUNC">(</span><span class="NAME">t.substring</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">}</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">t.substr</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">t.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"\u2026"</span><span class="PUNC">;</span><span class="NAME">this.setCloneText</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">box.style.width</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">box.offsetWidth</span><span class="PUNC">></span><span class="NAME">this.targetWidth</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t.length</span><span class="PUNC">==</span><span class="NUMB">4</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.setCloneText</span><span class="PUNC">(</span><span class="NAME">t.substring</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 53</span> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">}</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">t.substr</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">t.length</span><span class="PUNC">-</span><span class="NUMB">4</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"..."</span><span class="PUNC">;</span><span class="NAME">this.setCloneText</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">document.body.removeChild</span><span class="PUNC">(</span><span class="NAME">box</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setText</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">setText</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.hasInnerHTML</span><span class="PUNC">)</span><span class="NAME">this.domElement.innerHTML</span><span class="PUNC">=</span><span class="NAME">val</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.domElement.textContent</span><span class="PUNC">=</span><span class="NAME">val</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">setCloneText</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">clone.innerHTML</span><span class="PUNC">==</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">clone.textContent</span><span class="PUNC">=</span><span class="NAME">val</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">clone.innerHTML</span><span class="PUNC">=</span><span class="NAME">val</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getText</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.hasInnerHTML</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.domElement.innerHTML</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.domElement.textContent</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">setWidth</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.targetWidth</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 54</span> </span><span class="NAME">val</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">setHeight</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.targetHeight</span><span class="PUNC">=</span><span class="NAME">val</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Number.prototype.times</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">closure</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">closure.call</span><span class="PUNC">(</span><span class="NAME">scope</span><span class="PUNC">||</span><span class="NAME">arguments.callee.caller</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Number.prototype.upto</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">max</span><span class="PUNC">,</span><span class="NAME">closure</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">+</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;=</span><span class="NAME">max</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">closure.call</span><span class="PUNC">(</span><span class="NAME">scope</span><span class="PUNC">||</span><span class="NAME">arguments.callee.caller</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Number.prototype.downto</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">min</span><span class="PUNC">,</span><span class="NAME">closure</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">+</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">min</span><span class="PUNC">&lt;=</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="NAME">closure.call</span><span class="PUNC">(</span><span class="NAME">scope</span><span class="PUNC">||</span><span class="NAME">arguments.callee.caller</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 55</span> </span><span class="NAME">Number.prototype.step</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">limit</span><span class="PUNC">,</span><span class="NAME">step</span><span class="PUNC">,</span><span class="NAME">closure</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">+</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;=</span><span class="NAME">limit</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">step</span><span class="PUNC">)</span><span class="NAME">closure.call</span><span class="PUNC">(</span><span class="NAME">scope</span><span class="PUNC">||</span><span class="NAME">arguments.callee.caller</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Number.prototype.after</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">closure</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">closure.call</span><span class="PUNC">(</span><span class="NAME">scope</span><span class="PUNC">||</span><span class="NAME">arguments.callee.caller</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">+</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 56</span> </span><span class="NAME">Number.prototype.frames</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">closure</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">step</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">+</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">interval</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_core</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">System.FPS</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tid</span><span class="PUNC">=</span><span class="NAME">setInterval</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">closure.call</span><span class="PUNC">(</span><span class="NAME">scope</span><span class="PUNC">||</span><span class="NAME">arguments.callee.caller</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="NAME">clearInterval</span><span class="PUNC">(</span><span class="NAME">tid</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">==</span><span class="NAME">step</span><span class="PUNC">)</span><span class="NAME">clearInterval</span><span class="PUNC">(</span><span class="NAME">tid</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">interval</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Array.prototype.each</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">closure</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">closure.call</span><span class="PUNC">(</span><span class="NAME">scope</span><span class="PUNC">||</span><span class="NAME">arguments.callee.caller</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_canvas</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">use</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ns</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nscore</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_core</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">global.CanvasRenderingContext2D</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">CanvasRenderingContext2D.prototype.createImageData</span><span class="PUNC">&&</span><span class="NAME">global.ImageData</span><span class="PUNC">)</span><span class="NAME">CanvasRenderingContext2D.prototype.createImageData</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ImageData</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">globalCtx</span><span class="PUNC">=</span><span class="NAME">global.CanvasRenderingContext2D</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Color</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">col16</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.color</span><span class="PUNC">=</span><span class="NAME">col16</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">getter</span><span class="PUNC">(</span><span class="STRN">"r"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.color</span><span class="PUNC">>></span><span class="NUMB">16</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">setter</span><span class="PUNC">(</span><span class="STRN">"r"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.color</span><span class="PUNC">=</span><span class="NAME">val</span><span class="PUNC">&lt;&lt;</span><span class="WHIT">
<span class='line'> 57</span> </span><span class="NUMB">16</span><span class="PUNC">|</span><span class="NAME">this.g</span><span class="PUNC">&lt;&lt;</span><span class="NUMB">8</span><span class="PUNC">|</span><span class="NAME">this.b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">getter</span><span class="PUNC">(</span><span class="STRN">"g"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.color</span><span class="PUNC">>></span><span class="NUMB">8</span><span class="PUNC">&</span><span class="NUMB">255</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">setter</span><span class="PUNC">(</span><span class="STRN">"g"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.color</span><span class="PUNC">=</span><span class="NAME">this.r</span><span class="PUNC">&lt;&lt;</span><span class="NUMB">16</span><span class="PUNC">|</span><span class="NAME">this.b</span><span class="PUNC">&lt;&lt;</span><span class="NUMB">8</span><span class="PUNC">|</span><span class="NAME">this.b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">getter</span><span class="PUNC">(</span><span class="STRN">"b"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.color</span><span class="PUNC">&</span><span class="NUMB">255</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">setter</span><span class="PUNC">(</span><span class="STRN">"b"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.color</span><span class="PUNC">=</span><span class="NAME">this.r</span><span class="PUNC">&lt;&lt;</span><span class="NUMB">16</span><span class="PUNC">|</span><span class="NAME">this.g</span><span class="PUNC">&lt;&lt;</span><span class="NUMB">8</span><span class="PUNC">|</span><span class="NAME">val</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">BitmapData</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.w</span><span class="PUNC">=</span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.h</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">canvas</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"canvas"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">canvas</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.error</span><span class="PUNC">(</span><span class="STRN">"Your browser hasn't support HTML5 Canvas."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ctx</span><span class="PUNC">=</span><span class="NAME">canvas.getContext</span><span class="PUNC">(</span><span class="STRN">"2d"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">ctx</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.error</span><span class="PUNC">(</span><span class="STRN">"Your browser hasn't support HTML5 Canvas."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 58</span> </span><span class="KEYW">return</span><span class="PUNC">}</span><span class="NAME">this.imgData</span><span class="PUNC">=</span><span class="NAME">ctx.createImageData</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">getter</span><span class="PUNC">(</span><span class="STRN">"width"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.w</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">getter</span><span class="PUNC">(</span><span class="STRN">"height"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.h</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">singleton</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">CapStyle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.NONE</span><span class="PUNC">=</span><span class="STRN">"butt"</span><span class="PUNC">;</span><span class="NAME">$$.ROUND</span><span class="PUNC">=</span><span class="STRN">"round"</span><span class="PUNC">;</span><span class="NAME">$$.SQUARE</span><span class="PUNC">=</span><span class="STRN">"square"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">singleton</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">JointStyle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">args</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.BEVEL</span><span class="PUNC">=</span><span class="STRN">"bevel"</span><span class="PUNC">;</span><span class="NAME">$$.MITER</span><span class="PUNC">=</span><span class="STRN">"miter"</span><span class="PUNC">;</span><span class="NAME">$$.ROUND</span><span class="PUNC">=</span><span class="STRN">"round"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Graphics</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">displayObject</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.displayObject</span><span class="PUNC">=</span><span class="NAME">displayObject</span><span class="PUNC">;</span><span class="NAME">this.include</span><span class="PUNC">(</span><span class="NAME">nscore.Recordable.gen</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.needStroke</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">this.needFill</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 59</span> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">op</span><span class="PUNC">=</span><span class="NAME">nscore.Operation.gen</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">ctxInit</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.rec</span><span class="PUNC">(</span><span class="NAME">op</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.boundWidth</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.boundHeight</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">beginBitmapFill</span><span class="PUNC">(</span><span class="NAME">bmd</span><span class="PUNC">,</span><span class="NAME">matrix</span><span class="PUNC">,</span><span class="NAME">repeat</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">beginFill</span><span class="PUNC">(</span><span class="NAME">color</span><span class="PUNC">,</span><span class="NAME">alpha</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">alpha</span><span class="PUNC">==</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">alpha</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">col</span><span class="PUNC">=</span><span class="NAME">ns.Color.gen</span><span class="PUNC">(</span><span class="NAME">color</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">=</span><span class="STRN">"rgba("</span><span class="PUNC">+</span><span class="NAME">col.r</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">col.g</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">col.b</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">alpha</span><span class="PUNC">+</span><span class="STRN">")"</span><span class="PUNC">;</span><span class="NAME">this.rec</span><span class="PUNC">(</span><span class="NAME">nscore.Operation.gen</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">ctxNeedFill</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="KEYW">true</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.rec</span><span class="PUNC">(</span><span class="NAME">nscore.Operation.gen</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">ctxSetFillStyle</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">style</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">beginGradientFill</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">,</span><span class="NAME">colors</span><span class="PUNC">,</span><span class="NAME">alphas</span><span class="PUNC">,</span><span class="NAME">ratios</span><span class="PUNC">,</span><span class="NAME">matrix</span><span class="PUNC">,</span><span class="NAME">spreadMethod</span><span class="PUNC">,</span><span class="NAME">interpolationMethod</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 60</span> </span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">curveTo</span><span class="PUNC">(</span><span class="NAME">cpx</span><span class="PUNC">,</span><span class="NAME">cpy</span><span class="PUNC">,</span><span class="NAME">ax</span><span class="PUNC">,</span><span class="NAME">ay</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.rec</span><span class="PUNC">(</span><span class="NAME">nscore.Operation.gen</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">ctxCurveTo</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">cpx</span><span class="PUNC">,</span><span class="NAME">cpy</span><span class="PUNC">,</span><span class="NAME">ax</span><span class="PUNC">,</span><span class="NAME">ay</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">drawCircle</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.rec</span><span class="PUNC">(</span><span class="NAME">nscore.Operation.gen</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">ctxArc</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">drawEllipse</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">drawRect</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.rec</span><span class="PUNC">(</span><span class="NAME">nscore.Operation.gen</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">ctxFillRect</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">drawRoundRect</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">ellipseW</span><span class="PUNC">,</span><span class="NAME">ellipseH</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">endFill</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.rec</span><span class="PUNC">(</span><span class="NAME">nscore.Operation.gen</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">ctxEndFill</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">lineStyle</span><span class="PUNC">(</span><span class="NAME">thickness</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 61</span> </span><span class="NAME">color</span><span class="PUNC">,</span><span class="NAME">alpha</span><span class="PUNC">,</span><span class="NAME">caps</span><span class="PUNC">,</span><span class="NAME">joints</span><span class="PUNC">,</span><span class="NAME">miterLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">alpha</span><span class="PUNC">==</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">alpha</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">thickness</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">alpha</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">col</span><span class="PUNC">=</span><span class="NAME">ns.Color.gen</span><span class="PUNC">(</span><span class="NAME">color</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">=</span><span class="STRN">"rgba("</span><span class="PUNC">+</span><span class="NAME">col.r</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">col.g</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">col.b</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">alpha</span><span class="PUNC">+</span><span class="STRN">")"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">op</span><span class="PUNC">=</span><span class="NAME">nscore.Operation.gen</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">ctxSetLineStyle</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">thickness</span><span class="PUNC">,</span><span class="NAME">style</span><span class="PUNC">,</span><span class="NAME">caps</span><span class="PUNC">,</span><span class="NAME">joints</span><span class="PUNC">,</span><span class="NAME">miterLimit</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.rec</span><span class="PUNC">(</span><span class="NAME">op</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">lineTo</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">op</span><span class="PUNC">=</span><span class="NAME">nscore.Operation.gen</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">ctxLineTo</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.rec</span><span class="PUNC">(</span><span class="NAME">op</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">updateBound.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">moveTo</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.rec</span><span class="PUNC">(</span><span class="NAME">nscore.Operation.gen</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">ctxMoveTo</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">updateBound.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 62</span> </span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">bezierCurveTo</span><span class="PUNC">(</span><span class="NAME">cp1x</span><span class="PUNC">,</span><span class="NAME">cp1y</span><span class="PUNC">,</span><span class="NAME">cp2x</span><span class="PUNC">,</span><span class="NAME">cp2y</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.rec</span><span class="PUNC">(</span><span class="NAME">nscore.Operation.gen</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">ctxBezierCurveTo</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">cp1x</span><span class="PUNC">,</span><span class="NAME">cp1y</span><span class="PUNC">,</span><span class="NAME">cp2x</span><span class="PUNC">,</span><span class="NAME">cp2y</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">drawImage</span><span class="PUNC">(</span><span class="NAME">img</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.rec</span><span class="PUNC">(</span><span class="NAME">nscore.Operation.gen</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">ctxDrawImage</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">img</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">updateBound.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">img.width</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">img.height</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">drawText</span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.rec</span><span class="PUNC">(</span><span class="NAME">nscore.Operation.gen</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">ctxDrawText</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">text</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.context</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">metrics</span><span class="PUNC">=</span><span class="NAME">c.measureText</span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">updateBound.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">metrics.widht</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getGlobalX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.displayObject.globalX</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 63</span> </span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getGlobalY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.displayObject.globalY</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">getter</span><span class="PUNC">(</span><span class="STRN">"context"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.displayObject.stage.context</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ctxInit</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.context</span><span class="PUNC">;</span><span class="NAME">c.fillStyle</span><span class="PUNC">=</span><span class="STRN">"#000000"</span><span class="PUNC">;</span><span class="NAME">c.strokeStyle</span><span class="PUNC">=</span><span class="STRN">"#000000"</span><span class="PUNC">;</span><span class="NAME">c.lineWidth</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">c.lineCap</span><span class="PUNC">=</span><span class="NAME">ns.CapStyle.NONE</span><span class="PUNC">;</span><span class="NAME">c.lineJoin</span><span class="PUNC">=</span><span class="NAME">ns.JointStyle.MITER</span><span class="PUNC">;</span><span class="NAME">c.miterLimit</span><span class="PUNC">=</span><span class="NUMB">10</span><span class="PUNC">;</span><span class="NAME">c.closePath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.moveTo</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ctxNeedFill</span><span class="PUNC">(</span><span class="NAME">bool</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.needFill</span><span class="PUNC">=</span><span class="NAME">bool</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ctxNeedStroke</span><span class="PUNC">(</span><span class="NAME">bool</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.needStroke</span><span class="PUNC">=</span><span class="NAME">bool</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ctxSetFillStyle</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.context.fillStyle</span><span class="PUNC">=</span><span class="NAME">style</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ctxArc</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 64</span> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.context</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">gx</span><span class="PUNC">=</span><span class="NAME">this.getGlobalX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">gy</span><span class="PUNC">=</span><span class="NAME">this.getGlobalY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.arc</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">gx</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">gy</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Math.PI</span><span class="PUNC">*</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.needFill</span><span class="PUNC">)</span><span class="NAME">c.fill</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.needStroke</span><span class="PUNC">)</span><span class="NAME">c.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.closePath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ctxCurveTo</span><span class="PUNC">(</span><span class="NAME">cpx</span><span class="PUNC">,</span><span class="NAME">cpy</span><span class="PUNC">,</span><span class="NAME">ax</span><span class="PUNC">,</span><span class="NAME">ay</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">gx</span><span class="PUNC">=</span><span class="NAME">this.getGlobalX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">gy</span><span class="PUNC">=</span><span class="NAME">this.getGlobalY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.context</span><span class="PUNC">;</span><span class="NAME">c.quadraticCurveTo</span><span class="PUNC">(</span><span class="NAME">cpx</span><span class="PUNC">+</span><span class="NAME">gx</span><span class="PUNC">,</span><span class="NAME">cpy</span><span class="PUNC">+</span><span class="NAME">gy</span><span class="PUNC">,</span><span class="NAME">ax</span><span class="PUNC">+</span><span class="NAME">gx</span><span class="PUNC">,</span><span class="NAME">ay</span><span class="PUNC">+</span><span class="NAME">gy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.needFill</span><span class="PUNC">)</span><span class="NAME">this.context.fill</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.needStroke</span><span class="PUNC">)</span><span class="NAME">c.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ctxFillRect</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">gx</span><span class="PUNC">=</span><span class="NAME">this.getGlobalX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">gy</span><span class="PUNC">=</span><span class="NAME">this.getGlobalY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.context</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 65</span> </span><span class="NAME">c.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.context.fillRect</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">gx</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">gy</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.closePath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ctxEndFill</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.context</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.needFill</span><span class="PUNC">)</span><span class="NAME">c.fill</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.needStroke</span><span class="PUNC">)</span><span class="NAME">c.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.closePath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ctxSetLineStyle</span><span class="PUNC">(</span><span class="NAME">thickness</span><span class="PUNC">,</span><span class="NAME">style</span><span class="PUNC">,</span><span class="NAME">caps</span><span class="PUNC">,</span><span class="NAME">joints</span><span class="PUNC">,</span><span class="NAME">miterLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.context</span><span class="PUNC">;</span><span class="NAME">c.strokeStyle</span><span class="PUNC">=</span><span class="NAME">style</span><span class="PUNC">;</span><span class="NAME">c.lineWidth</span><span class="PUNC">=</span><span class="NAME">thickness</span><span class="PUNC">;</span><span class="NAME">c.lineCap</span><span class="PUNC">=</span><span class="NAME">caps</span><span class="PUNC">;</span><span class="NAME">c.lineJoin</span><span class="PUNC">=</span><span class="NAME">joints</span><span class="PUNC">;</span><span class="NAME">c.miterLimit</span><span class="PUNC">=</span><span class="NAME">miterLimit</span><span class="PUNC">;</span><span class="NAME">this.needStroke</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="NAME">c.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ctxLineTo</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.context</span><span class="PUNC">;</span><span class="NAME">c.lineTo</span><span class="PUNC">(</span><span class="NAME">this.getGlobalX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">this.getGlobalY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.needFill</span><span class="PUNC">)</span><span class="NAME">c.fill</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 66</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.needStroke</span><span class="PUNC">)</span><span class="NAME">c.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ctxMoveTo</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.context.moveTo</span><span class="PUNC">(</span><span class="NAME">this.getGlobalX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">this.getGlobalY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ctxBezierCurveTo</span><span class="PUNC">(</span><span class="NAME">cp1x</span><span class="PUNC">,</span><span class="NAME">cp1y</span><span class="PUNC">,</span><span class="NAME">cp2x</span><span class="PUNC">,</span><span class="NAME">cp2y</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">gx</span><span class="PUNC">=</span><span class="NAME">this.getGlobalX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">gy</span><span class="PUNC">=</span><span class="NAME">this.getGlobalY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.context</span><span class="PUNC">;</span><span class="NAME">c.bezierCurveTo</span><span class="PUNC">(</span><span class="NAME">cp1x</span><span class="PUNC">+</span><span class="NAME">gx</span><span class="PUNC">,</span><span class="NAME">cp1y</span><span class="PUNC">+</span><span class="NAME">gx</span><span class="PUNC">,</span><span class="NAME">cp2x</span><span class="PUNC">+</span><span class="NAME">gx</span><span class="PUNC">,</span><span class="NAME">cp2y</span><span class="PUNC">+</span><span class="NAME">gy</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">gx</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">gy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.needFill</span><span class="PUNC">)</span><span class="NAME">c.fill</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.needStroke</span><span class="PUNC">)</span><span class="NAME">c.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ctxDrawImage</span><span class="PUNC">(</span><span class="NAME">img</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">gx</span><span class="PUNC">=</span><span class="NAME">this.getGlobalX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">gy</span><span class="PUNC">=</span><span class="NAME">this.getGlobalY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.context.drawImage</span><span class="PUNC">(</span><span class="NAME">img</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">gx</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">gy</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ctxDrawText</span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">gx</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 67</span> </span><span class="NAME">this.getGlobalX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">gy</span><span class="PUNC">=</span><span class="NAME">this.getGlobalY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.context.fillText</span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">gx</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">gy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.context.strokeText</span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">gx</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">gy</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">updateBound</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.boundWidth</span><span class="PUNC">&lt;</span><span class="NAME">x</span><span class="PUNC">)</span><span class="NAME">this.boundWidth</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.boundHeight</span><span class="PUNC">&lt;</span><span class="NAME">y</span><span class="PUNC">)</span><span class="NAME">this.boundHeight</span><span class="PUNC">=</span><span class="NAME">y</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">DisplayObject</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._mx</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this._my</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this._g</span><span class="PUNC">=</span><span class="NAME">ns.Graphics.gen</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this._stg</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this._sx</span><span class="PUNC">=</span><span class="NAME">this._sy</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.visible</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="NAME">this.alpha</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this._g.context</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">sX</span><span class="PUNC">=</span><span class="NAME">this.scaleX</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">sY</span><span class="PUNC">=</span><span class="NAME">this.scaleY</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">offsetX</span><span class="PUNC">=</span><span class="NAME">this.globalX</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 68</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">offsetY</span><span class="PUNC">=</span><span class="NAME">this.globalY</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">sX</span><span class="PUNC">!=</span><span class="NUMB">1</span><span class="PUNC">||</span><span class="NAME">sY</span><span class="PUNC">!=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c.setTransform</span><span class="PUNC">(</span><span class="NAME">sX</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">sY</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">offsetX</span><span class="PUNC">*</span><span class="NAME">sX</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">offsetY</span><span class="PUNC">*</span><span class="NAME">sY</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.translate</span><span class="PUNC">(</span><span class="NAME">offsetX</span><span class="PUNC">/</span><span class="NAME">sX</span><span class="PUNC">,</span><span class="NAME">offsetY</span><span class="PUNC">/</span><span class="NAME">sY</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.visible</span><span class="PUNC">)</span><span class="NAME">this._g.playback</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">sX</span><span class="PUNC">!=</span><span class="NUMB">1</span><span class="PUNC">||</span><span class="NAME">sY</span><span class="PUNC">!=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="NAME">c.setTransform</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">getter</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._mx</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">setter</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._mx</span><span class="PUNC">=</span><span class="NAME">val</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">getter</span><span class="PUNC">(</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._my</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">setter</span><span class="PUNC">(</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._my</span><span class="PUNC">=</span><span class="NAME">val</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">getter</span><span class="PUNC">(</span><span class="STRN">"width"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._g.boundWidth</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">getter</span><span class="PUNC">(</span><span class="STRN">"height"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._g.boundHeight</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">getter</span><span class="PUNC">(</span><span class="STRN">"scaleX"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._sx</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'> 69</span> </span><span class="PUNC">(</span><span class="NAME">this.parent</span><span class="PUNC">?</span><span class="NAME">this.parent.scaleX</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">setter</span><span class="PUNC">(</span><span class="STRN">"scaleX"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._sx</span><span class="PUNC">=</span><span class="NAME">val</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">getter</span><span class="PUNC">(</span><span class="STRN">"scaleY"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._sy</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.parent</span><span class="PUNC">?</span><span class="NAME">this.parent.scaleY</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">setter</span><span class="PUNC">(</span><span class="STRN">"scaleY"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._sx</span><span class="PUNC">=</span><span class="NAME">val</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">getter</span><span class="PUNC">(</span><span class="STRN">"globalX"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.parent</span><span class="PUNC">==</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._mx</span><span class="PUNC">+</span><span class="NAME">this.parent.globalX</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">getter</span><span class="PUNC">(</span><span class="STRN">"globalY"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.parent</span><span class="PUNC">==</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._my</span><span class="PUNC">+</span><span class="NAME">this.parent.globalY</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">getter</span><span class="PUNC">(</span><span class="STRN">"stage"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._stg</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">getter</span><span class="PUNC">(</span><span class="STRN">"graphics"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._g</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 70</span> </span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">DisplayObjectContainer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ex</span><span class="PUNC">(</span><span class="NAME">ns.DisplayObject</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.$super</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.children</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this._stg</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">addChild</span><span class="PUNC">(</span><span class="NAME">child</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.numChildren.times</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.children</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">child</span><span class="PUNC">)</span><span class="NAME">this.children.splice</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.children.push</span><span class="PUNC">(</span><span class="NAME">child</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">child.parent</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">child._stg</span><span class="PUNC">=</span><span class="NAME">this._stg</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">addChildAt</span><span class="PUNC">(</span><span class="NAME">child</span><span class="PUNC">,</span><span class="NAME">index</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">numChildren</span><span class="PUNC">=</span><span class="NAME">this.numChildren</span><span class="PUNC">;</span><span class="NAME">numChildren.times</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.children</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">child</span><span class="PUNC">)</span><span class="NAME">this.children.splice</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">left</span><span class="PUNC">=</span><span class="NAME">this.children.splice</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 71</span> </span><span class="NAME">index</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">right</span><span class="PUNC">=</span><span class="NAME">this.children.splice</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.numChildren</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">left.push</span><span class="PUNC">(</span><span class="NAME">child</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.children</span><span class="PUNC">=</span><span class="NAME">left.concat</span><span class="PUNC">(</span><span class="NAME">right</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">child.parent</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">child._stg</span><span class="PUNC">=</span><span class="NAME">this._stg</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">removeChild</span><span class="PUNC">(</span><span class="NAME">child</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.children.each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">==</span><span class="NAME">child</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.children.splice</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">}</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.$super</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.numChildren.times</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.children</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">getter</span><span class="PUNC">(</span><span class="STRN">"numChildren"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.children.length</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Stage</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ex</span><span class="PUNC">(</span><span class="NAME">ns.DisplayObjectContainer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">canvas</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 72</span> </span><span class="NAME">canvas.getContext</span><span class="PUNC">(</span><span class="STRN">"2d"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.error</span><span class="PUNC">(</span><span class="STRN">"Your browser hasn't support HTML5 Canvas."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">}</span><span class="NAME">this.context</span><span class="PUNC">=</span><span class="NAME">context</span><span class="PUNC">;</span><span class="NAME">this.w</span><span class="PUNC">=</span><span class="NAME">canvas.width</span><span class="PUNC">;</span><span class="NAME">this.h</span><span class="PUNC">=</span><span class="NAME">canvas.height</span><span class="PUNC">;</span><span class="NAME">this._stg</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">addChild</span><span class="PUNC">(</span><span class="NAME">child</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.$super</span><span class="PUNC">(</span><span class="NAME">child</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.numChildren.times</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.children</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">getter</span><span class="PUNC">(</span><span class="STRN">"stageWidth"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.w</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">getter</span><span class="PUNC">(</span><span class="STRN">"stageHeight"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.h</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Namespace</span><span class="PUNC">(</span><span class="NAME">namespace_lib_math</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">use</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ns</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">Math</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Math</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$$.factorial</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">n</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">ns.Math.factorial</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">$$.sigma</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">$$.log</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">base</span><span class="PUNC">,</span><span class="NAME">trueValue</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">M.log</span><span class="PUNC">(</span><span class="NAME">trueValue</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">M.log</span><span class="PUNC">(</span><span class="NAME">base</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">$$.sugar</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nativeMath</span><span class="PUNC">=</span><span class="NAME">global.Math</span><span class="PUNC">;</span><span class="NAME">global.PI</span><span class="PUNC">=</span><span class="NAME">nativeMath.PI</span><span class="PUNC">;</span><span class="NAME">global.E</span><span class="PUNC">=</span><span class="NAME">nativeMath.E</span><span class="PUNC">;</span><span class="NAME">global.sqrt</span><span class="PUNC">=</span><span class="NAME">nativeMath.sqrt</span><span class="PUNC">;</span><span class="NAME">global.abs</span><span class="PUNC">=</span><span class="NAME">nativeMath.abs</span><span class="PUNC">;</span><span class="NAME">global.acos</span><span class="PUNC">=</span><span class="NAME">nativeMath.acos</span><span class="PUNC">;</span><span class="NAME">global.asin</span><span class="PUNC">=</span><span class="NAME">nativeMath.atan</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 73</span> </span><span class="NAME">global.atan</span><span class="PUNC">=</span><span class="NAME">nativeMath.atan</span><span class="PUNC">;</span><span class="NAME">global.atan2</span><span class="PUNC">=</span><span class="NAME">nativeMath.atan2</span><span class="PUNC">;</span><span class="NAME">global.ceil</span><span class="PUNC">=</span><span class="NAME">nativeMath.ceil</span><span class="PUNC">;</span><span class="NAME">global.sin</span><span class="PUNC">=</span><span class="NAME">nativeMath.sin</span><span class="PUNC">;</span><span class="NAME">global.cos</span><span class="PUNC">=</span><span class="NAME">nativeMath.cos</span><span class="PUNC">;</span><span class="NAME">global.tan</span><span class="PUNC">=</span><span class="NAME">nativeMath.tan</span><span class="PUNC">;</span><span class="NAME">global.exp</span><span class="PUNC">=</span><span class="NAME">nativeMath.exp</span><span class="PUNC">;</span><span class="NAME">global.floor</span><span class="PUNC">=</span><span class="NAME">nativeMath.floor</span><span class="PUNC">;</span><span class="NAME">global.LN10</span><span class="PUNC">=</span><span class="NAME">nativeMath.LN10</span><span class="PUNC">;</span><span class="NAME">global.LN2</span><span class="PUNC">=</span><span class="NAME">nativeMath.LN2</span><span class="PUNC">;</span><span class="NAME">global.log</span><span class="PUNC">=</span><span class="NAME">nativeMath.log</span><span class="PUNC">;</span><span class="NAME">global.LOG10E</span><span class="PUNC">=</span><span class="NAME">nativeMath.LOG10E</span><span class="PUNC">;</span><span class="NAME">global.LOG2E</span><span class="PUNC">=</span><span class="NAME">nativeMath.LOG2E</span><span class="PUNC">;</span><span class="NAME">global.max</span><span class="PUNC">=</span><span class="NAME">nativeMath.max</span><span class="PUNC">;</span><span class="NAME">global.min</span><span class="PUNC">=</span><span class="NAME">nativeMath.min</span><span class="PUNC">;</span><span class="NAME">global.random</span><span class="PUNC">=</span><span class="NAME">nativeMath.random</span><span class="PUNC">;</span><span class="NAME">global.round</span><span class="PUNC">=</span><span class="NAME">nativeMath.round</span><span class="PUNC">;</span><span class="NAME">global.SQRT1_2</span><span class="PUNC">=</span><span class="NAME">nativeMath.SQRT1_2</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 74</span> </span><span class="NAME">global.SQRT2</span><span class="PUNC">=</span><span class="NAME">nativeMath.SQRT2</span><span class="PUNC">;</span><span class="NAME">global.DFT</span><span class="PUNC">=</span><span class="NAME">this.DFT</span><span class="PUNC">;</span><span class="NAME">global.FFT</span><span class="PUNC">=</span><span class="NAME">this.FFT</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">DFT</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.N</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">dft</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dt</span><span class="PUNC">=</span><span class="NAME">this.N</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">calcR</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">calcI</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">dt</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">calcR</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">calcI</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">fn</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">/</span><span class="NAME">dt</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">pi2ft</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">M.PI</span><span class="PUNC">*</span><span class="NAME">fn</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">&lt;</span><span class="NAME">dt</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">calcR</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">M.cos</span><span class="PUNC">(</span><span class="NAME">pi2ft</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">calcI</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">M.sin</span><span class="PUNC">(</span><span class="NAME">pi2ft</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">dt</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">calcR</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">y</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">calcI</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">proto</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">FFT</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">init</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.N</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">this.bitrev</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">betrev</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">,</span><span class="NAME">this.bitrev</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.sintable</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">sintbl</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 75</span> </span><span class="NAME">this.sintable</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">def</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">fft</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">last_n</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">bitrev</span><span class="PUNC">=</span><span class="NAME">this.bitrev</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">sintbl</span><span class="PUNC">=</span><span class="NAME">this.sintable</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.N</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">ik</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">k2</span><span class="PUNC">,</span><span class="NAME">n4</span><span class="PUNC">,</span><span class="NAME">inverse</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">dx</span><span class="PUNC">,</span><span class="NAME">dy</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">&lt;</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">n</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">inverse</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">inverse</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">n4</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">>></span><span class="NUMB">2</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">bitrev</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">y</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">y</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">y</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">y</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">&lt;</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">k2</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">k2</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">+</span><span class="NAME">k</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">/</span><span class="NAME">k2</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">k</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">sintbl</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">n4</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">inverse</span><span class="PUNC">)</span><span class="NAME">s</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">sintbl</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">sintbl</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">k2</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ik</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NAME">k</span><span class="PUNC">;</span><span class="NAME">dx</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">*</span><span class="NAME">y</span><span class="PUNC">[</span><span class="NAME">ik</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">x</span><span class="PUNC">[</span><span class="NAME">ik</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">dy</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">y</span><span class="PUNC">[</span><span class="NAME">ik</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">*</span><span class="NAME">x</span><span class="PUNC">[</span><span class="NAME">ik</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">[</span><span class="NAME">ik</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">dx</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">dx</span><span class="PUNC">;</span><span class="NAME">y</span><span class="PUNC">[</span><span class="NAME">ik</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">y</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">dy</span><span class="PUNC">;</span><span class="NAME">y</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">dy</span><span class="PUNC">}</span><span class="NAME">h</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 76</span> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">betrev</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">,</span><span class="NAME">table</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">table</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="PUNC">++</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">N</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">>></span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">&lt;=</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">j</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">>></span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="NAME">j</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">;</span><span class="NAME">table</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">sintbl</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">,</span><span class="NAME">table</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">n2</span><span class="PUNC">,</span><span class="NAME">n4</span><span class="PUNC">,</span><span class="NAME">n8</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">dc</span><span class="PUNC">,</span><span class="NAME">ds</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">n2</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">>></span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">n4</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">>></span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">n8</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">>></span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">M.sin</span><span class="PUNC">(</span><span class="NAME">M.PI</span><span class="PUNC">/</span><span class="NAME">N</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">dc</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">ds</span><span class="PUNC">=</span><span class="NAME">M.sqrt</span><span class="PUNC">(</span><span class="NAME">dc</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">-</span><span class="NAME">dc</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">dc</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">table</span><span class="PUNC">[</span><span class="NAME">n4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">table</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">n8</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">dc</span><span class="PUNC">;</span><span class="NAME">dc</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">ds</span><span class="PUNC">;</span><span class="NAME">ds</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">table</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">table</span><span class="PUNC">[</span><span class="NAME">n4</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">n8</span><span class="PUNC">!=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">table</span><span class="PUNC">[</span><span class="NAME">n8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">M.sqrt</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">n4</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">table</span><span class="PUNC">[</span><span class="NAME">n2</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">table</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">n2</span><span class="PUNC">+</span><span class="NAME">n4</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">table</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NAME">n2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">table</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 77</span> </span></pre></body></html>